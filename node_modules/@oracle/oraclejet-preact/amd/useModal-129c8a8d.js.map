{"version":3,"file":"useModal-129c8a8d.js","sources":["../../src/UNSAFE_Modal/hooks/useModal.ts"],"sourcesContent":["import { useRef, useCallback, useEffect } from 'preact/compat';\n\nexport type UseModalProps = Readonly<{\n  /**\n   * Determines whether the Modal is open.\n   */\n  isOpen: boolean;\n  /**\n   * On backdrop click callback.\n   */\n  onBackdropClick?: () => void;\n}>;\n\n/**\n *\n * @param props\n */\nexport const useModal = (props: UseModalProps) => {\n  const { isOpen, onBackdropClick: onBackdropClickProp } = props;\n\n  const backdropRef = useRef<HTMLDivElement>(null);\n\n  const mouseDownTarget = useRef<EventTarget | null>(null);\n\n  const onMouseDown = useCallback((event: MouseEvent) => {\n    if (backdropRef.current === event.target) {\n      mouseDownTarget.current = event.target;\n    }\n  }, []);\n\n  const onBackdropClick = useCallback(\n    (event: MouseEvent) => {\n      if (backdropRef.current === event.target) {\n        event.stopPropagation();\n        // event should originate on the same target\n        if (mouseDownTarget.current === event.target) {\n          onBackdropClickProp?.();\n        }\n      }\n    },\n    [onBackdropClickProp]\n  );\n\n  useEffect(() => {\n    const modal = backdropRef.current;\n\n    if (modal) {\n      modal.addEventListener('mousedown', onMouseDown);\n      modal.addEventListener('click', onBackdropClick);\n\n      return () => {\n        modal.removeEventListener('mousedown', onMouseDown);\n        modal.removeEventListener('click', onBackdropClick);\n      };\n    }\n\n    return () => {};\n  }, [isOpen, onMouseDown, onBackdropClick]);\n\n  return {\n    backdropRef\n  };\n};\n\nexport default useModal;\n"],"names":["props","isOpen","onBackdropClick","onBackdropClickProp","backdropRef","useRef","mouseDownTarget","onMouseDown","useCallback","event","current","target","stopPropagation","useEffect","modal","addEventListener","removeEventListener"],"mappings":"0EAiByBA,IACvB,MAAMC,OAAEA,EAAQC,gBAAiBC,GAAwBH,EAEnDI,EAAcC,SAAuB,MAErCC,EAAkBD,SAA2B,MAE7CE,EAAcC,eAAaC,IAC3BL,EAAYM,UAAYD,EAAME,SAChCL,EAAgBI,QAAUD,EAAME,OACjC,GACA,IAEGT,EAAkBM,eACrBC,IACKL,EAAYM,UAAYD,EAAME,SAChCF,EAAMG,kBAEFN,EAAgBI,UAAYD,EAAME,QACpCR,MAEH,GAEH,CAACA,IAmBH,OAhBAU,EAAAA,WAAU,KACR,MAAMC,EAAQV,EAAYM,QAE1B,OAAII,GACFA,EAAMC,iBAAiB,YAAaR,GACpCO,EAAMC,iBAAiB,QAASb,GAEzB,KACLY,EAAME,oBAAoB,YAAaT,GACvCO,EAAME,oBAAoB,QAASd,EAAgB,GAIhD,MAAQ,GACd,CAACD,EAAQM,EAAaL,IAElB,CACLE,cACD"}