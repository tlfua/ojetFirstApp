{"version":3,"file":"TabBarItem-953b0b2c.js","sources":["../../src/UNSAFE_TabBar/TabBarContext.ts","../../src/UNSAFE_TabBar/TabBar.tsx","../../src/UNSAFE_TabBar/useTabBarContext.ts","../../src/UNSAFE_TabBar/TabBarItem.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { createContext } from 'preact';\nimport { TabBarProps } from './TabBar';\nimport { MutableRefObject } from 'preact/compat';\n\ntype TabBarContextProps<K extends string | number> = Pick<\n  TabBarProps<K>,\n  'layout' | 'selection' | 'onSelectionChange'\n> & {\n  currentKey?: K;\n  showFocusRing: boolean;\n  isActiveElement: () => boolean;\n  isFirstItemRendered?: MutableRefObject<boolean>;\n};\n/**\n * Context used to pass TabBar information without having to pass it to TabBar children props.\n * We want to communicate information down to any interested TabBar item children.\n */\n\nconst TabBarContext = createContext<TabBarContextProps<string | number>>(null!);\n\nexport { TabBarContext };\n","import { ComponentChildren } from 'preact';\nimport { useState, useRef, useCallback, useEffect } from 'preact/hooks';\nimport { keyExtractor, getPrevNextKey } from '../utils/PRIVATE_collectionUtils';\nimport { mergeProps } from '../utils/UNSAFE_mergeProps';\nimport { classNames } from '../utils/UNSAFE_classNames';\nimport { useCollectionFocusRing } from '../hooks/PRIVATE_useCollectionFocusRing';\nimport { useCurrentKey } from '../hooks/PRIVATE_useCurrentKey';\nimport { Flex } from '../UNSAFE_Flex';\nimport { TabBarContext } from './TabBarContext';\nimport { useUser } from '../hooks/UNSAFE_useUser';\nimport { styles } from './themes/TabBarStyles.css';\n\n/**\n * type for payload of current key change event handler\n */\nexport type CurrentKeyDetail<K> = {\n  value: K;\n};\n\n/**\n * type for payload of selection change event handler\n */\ntype SelectionDetail<K> = {\n  value: K;\n};\n\nexport type TabBarProps<K extends string | number> = {\n  /**\n   * A set of TabBarItem(s) that TabBar will hold\n   */\n  children: ComponentChildren;\n  /**\n   * Whether to stretch the tab bar items to occupy available space or to condense items\n   */\n  layout?: 'stretch' | 'condense';\n  /**\n   * Key of the selected item.\n   */\n  selection?: K;\n  /**\n   * Callback function to handle when selection has changed\n   */\n  onSelectionChange?: <K extends string | number>(detail: SelectionDetail<K>) => void;\n};\n\nexport function TabBar<K extends string | number>({\n  children,\n  layout = 'stretch',\n  selection,\n  onSelectionChange\n}: TabBarProps<K>) {\n  const rootRef = useRef<HTMLDivElement>(null);\n  const isFirstItemRendered = useRef<boolean>(false);\n  const [currentKey, setCurrentKey] = useState<K | undefined>(selection);\n  const [showFocusRing, focusRingProps] = useCollectionFocusRing(\n    (elem: Element | null) => {\n      return !!rootRef.current?.contains(elem);\n    },\n    ['ArrowRight', 'ArrowLeft']\n  );\n\n  const ITEM_SELECTOR = '.' + 'oj-c-tabbar-item';\n\n  const { currentKeyProps } = useCurrentKey(\n    (element) => keyExtractor(element, ITEM_SELECTOR),\n    false,\n    undefined,\n    undefined,\n    getPrevNextKey(rootRef.current, currentKey, true, ITEM_SELECTOR),\n    getPrevNextKey(rootRef.current, currentKey, false, ITEM_SELECTOR),\n    currentKey,\n    (detail: CurrentKeyDetail<K | undefined>) => setCurrentKey(detail.value)\n  );\n\n  //If selection is undefined the currentKey would be undefined in that case keyboard\n  //navigation using useCurrentKey is not possible as it expects a valid currentKey\n  const { direction } = useUser();\n  const isRtl = direction === 'rtl';\n  const onKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (currentKey === undefined) {\n        if (event.key === 'ArrowRight' || (!isRtl && event.key === 'ArrowLeft')) {\n          const targetKey = (event.target as HTMLDivElement).getAttribute('data-oj-key');\n          if (targetKey) {\n            const nextKey = getPrevNextKey(rootRef.current, targetKey, false, ITEM_SELECTOR)();\n            if (nextKey !== null) {\n              setCurrentKey(nextKey as K);\n            }\n          }\n        }\n      }\n    },\n    [currentKey]\n  );\n\n  const onKeyDownProps = { onKeyDown };\n\n  useEffect(() => {\n    isFirstItemRendered.current = false;\n  });\n\n  const isActiveElement = useCallback(() => {\n    return !!rootRef?.current?.contains(document.activeElement);\n  }, []);\n\n  const tabBarClass = classNames([styles.tabBarBase]);\n  return (\n    <TabBarContext.Provider\n      value={{\n        selection,\n        onSelectionChange,\n        currentKey,\n        showFocusRing,\n        layout,\n        isActiveElement,\n        isFirstItemRendered\n      }}>\n      <div\n        class={tabBarClass}\n        role={'tablist'}\n        ref={rootRef}\n        tabIndex={children ? -1 : 0}\n        aria-multiselectable={false}\n        {...mergeProps(onKeyDownProps, currentKeyProps, focusRingProps)}>\n        <Flex direction=\"row\" gap=\"8x\">\n          {children}\n        </Flex>\n      </div>\n    </TabBarContext.Provider>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { useContext } from 'preact/hooks';\nimport { TabBarContext } from './TabBarContext';\n\n/**\n * Utility hook for consuming the TabBarContext\n *\n * @returns The value of TabBarContext provider\n */\nfunction useTabBarContext() {\n  return useContext(TabBarContext);\n}\n\nexport { useTabBarContext };\n","import { ComponentChildren } from 'preact';\nimport { useRef, useLayoutEffect } from 'preact/hooks';\nimport { classNames } from '../utils/UNSAFE_classNames';\nimport { usePress } from '../hooks/UNSAFE_usePress';\nimport { Text } from '../UNSAFE_Text';\nimport { Flex } from '../UNSAFE_Flex';\nimport { useTabBarContext } from './useTabBarContext';\nimport { mergeInterpolations } from '../utils/UNSAFE_mergeInterpolations';\nimport { flexitemInterpolations } from '../utils/UNSAFE_interpolations/flexitem';\nimport type { FlexitemProps } from '../utils/UNSAFE_interpolations/flexitem';\nimport { useComponentTheme } from '../hooks/UNSAFE_useComponentTheme';\nimport { TabBarItemVariantOptions } from './themes/TabBarItemStyles.css';\nimport { TabBarItemRedwoodTheme } from './themes/redwood/TabBarItemTheme';\n\nexport type TabBarItemProps<K extends string | number> = {\n  /**\n   * Key of the TabBarItem\n   */\n  itemKey: K;\n  /**\n   * Label of the TabBarItem\n   */\n  label?: string;\n  /**\n   * The content to be rendered before the tab label\n   */\n  startContent?: ComponentChildren;\n  /**\n   * The content to be rendered after the tab label\n   */\n  endContent?: ComponentChildren;\n};\n\nconst ITEM_STYLE_CLASS = 'oj-c-tabbar-item';\n\nexport function TabBarItem<K extends string | number>({\n  itemKey,\n  label,\n  startContent,\n  endContent\n}: TabBarItemProps<K>) {\n  const tabBarItemRef = useRef<HTMLDivElement | null>(null);\n  const {\n    onSelectionChange,\n    selection,\n    currentKey,\n    showFocusRing,\n    layout,\n    isActiveElement,\n    isFirstItemRendered\n  } = useTabBarContext();\n\n  const isCurrent = currentKey === itemKey;\n  let tabIndex = isCurrent ? 0 : -1;\n  //If currentKey is undefined, in order to tab to a TabBarItem, the first TabBarItem should set its tabindex to 0\n  if (currentKey === undefined && isFirstItemRendered && !isFirstItemRendered.current) {\n    tabIndex = 0;\n    isFirstItemRendered.current = true;\n  }\n\n  //Selection\n  const handlePress = () => {\n    onSelectionChange?.({ value: itemKey as K });\n  };\n\n  const { pressProps } = usePress(handlePress);\n\n  const isSelected = selection === itemKey;\n\n  useLayoutEffect(() => {\n    if (isActiveElement?.() && isCurrent) {\n      tabBarItemRef?.current?.focus();\n    }\n  }, [isCurrent, isActiveElement]);\n\n  const {\n    classes,\n    styles: { tabBarItemStartContent, tabBarItemEndContent }\n  } = useComponentTheme<TabBarItemVariantOptions>(TabBarItemRedwoodTheme, {\n    selection: isSelected ? 'isSelected' : 'notSelected',\n    current: isCurrent ? 'isCurrent' : 'notCurrent',\n    focusRing: showFocusRing ? 'showFocusRing' : 'noFocusRing'\n  });\n\n  const tabBarItem = classNames([classes, ITEM_STYLE_CLASS]);\n\n  const tabBarItemStartContentClasses = classNames([tabBarItemStartContent]);\n  const tabBarItemEndContentClasses = classNames([tabBarItemEndContent]);\n\n  //instead of specifying flex: '1 0 auto' in cssProps var\n  const styleInterpolations = mergeInterpolations<FlexitemProps>([\n    ...Object.values(flexitemInterpolations)\n  ]);\n  const flexDimensions = styleInterpolations({\n    flex: layout === 'stretch' ? '1 0 auto' : '0 0 auto'\n  });\n\n  return (\n    <div\n      data-oj-key={itemKey}\n      class={tabBarItem}\n      role=\"tab\"\n      ref={tabBarItemRef}\n      {...pressProps}\n      aria-selected={isSelected}\n      tabIndex={tabIndex}\n      style={flexDimensions}>\n      <Flex\n        height=\"11x\"\n        minWidth=\"14x\"\n        direction=\"row\"\n        gap=\"2x\"\n        align=\"center\"\n        justify=\"center\"\n        flex=\"1 1 auto\">\n        {startContent && <span class={tabBarItemStartContentClasses}>{startContent}</span>}\n        {label && (\n          <Text size=\"md\" weight=\"semiBold\">\n            {label}\n          </Text>\n        )}\n        {endContent && <span class={tabBarItemEndContentClasses}>{endContent}</span>}\n      </Flex>\n    </div>\n  );\n}\n"],"names":["createContext","useRef","useState","useCollectionFocusRing","useCurrentKey","keyExtractor","getPrevNextKey","useUser","useCallback","useEffect","classNames","styles","_jsx","mergeProps","Flex","useContext","usePress","useLayoutEffect","useComponentTheme","TabBarItemRedwoodTheme","mergeInterpolations","flexitemInterpolations","_jsxs","Text"],"mappings":"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"}