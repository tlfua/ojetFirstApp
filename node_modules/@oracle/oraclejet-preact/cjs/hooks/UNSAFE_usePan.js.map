{"version":3,"file":"UNSAFE_usePan.js","sources":["../../../src/hooks/UNSAFE_usePan/usePan.ts","../../../src/hooks/UNSAFE_usePan/index.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { useRef, useCallback } from 'preact/hooks';\n\n/*\nthreshold: Minimal distance in pixels required before recognizing\n*/\ntype PanOptions = {\n  threshold?: number;\n  minimumTime?: number;\n  isDisabled?: boolean;\n};\n\ntype PanInfo = {\n  x: number;\n  y: number;\n  status: 'start' | 'end' | 'move';\n};\n\ntype PanState = {\n  pointerDownId: number | null;\n  startTime: number | null;\n  prevOffsetX: number;\n  prevOffsetY: number;\n};\n\nexport function usePan(\n  onPan: (e: PanInfo) => void,\n  { threshold = 50, minimumTime = 500, isDisabled = false }: PanOptions = {\n    threshold: 50,\n    minimumTime: 500,\n    isDisabled: false\n  }\n): { panProps: Record<string, any> } {\n  const ref = useRef<PanState>({\n    pointerDownId: 0,\n    startTime: 0,\n    prevOffsetX: 0,\n    prevOffsetY: 0\n  });\n\n  const onPointerDown = useCallback((e: PointerEvent) => {\n    if (!ref.current.pointerDownId) {\n      ref.current = {\n        pointerDownId: e.pointerId,\n        startTime: e.timeStamp,\n        prevOffsetX: e.offsetX,\n        prevOffsetY: e.offsetY\n      };\n      onPan?.({ x: e.clientX, y: e.clientY, status: 'start' });\n    } else {\n      clearPan();\n    }\n  }, []);\n\n  const onPointerMove = (e: PointerEvent) => {\n    if (ref.current.pointerDownId === e.pointerId) {\n      onPan?.({ x: e.clientX, y: e.clientY, status: 'move' });\n    }\n  };\n\n  const onPointerUp = useCallback(\n    (ev: PointerEvent) => {\n      if (ev.pointerId === ref.current.pointerDownId) {\n        if (ref.current.startTime && ev.timeStamp - ref.current.startTime >= minimumTime) {\n          const horizontalThreshold = ev.offsetX - ref.current.prevOffsetX;\n          const verticalThreshold = ev.offsetY - ref.current.prevOffsetY;\n          if (Math.abs(horizontalThreshold) > Math.abs(verticalThreshold)) {\n            // pan-left or pan-right\n            if (ref.current.prevOffsetX - ev.offsetX > threshold) {\n              onPan?.({ x: ev.clientX, y: ev.clientY, status: 'end' });\n            } else if (ev.offsetX - ref.current.prevOffsetX > threshold) {\n              onPan?.({ x: ev.clientX, y: ev.clientY, status: 'end' });\n            }\n          } else {\n            // pan-up or pan-down\n            if (ref.current.prevOffsetY - ev.offsetY > threshold) {\n              onPan?.({ x: ev.clientX, y: ev.clientY, status: 'end' });\n            } else if (ev.offsetY - ref.current.prevOffsetY > threshold) {\n              onPan?.({ x: ev.clientX, y: ev.clientY, status: 'end' });\n            }\n          }\n        }\n      }\n      // state would be reset to its original state whether pan is completed or cancelled\n      clearPan();\n    },\n    [threshold, onPan]\n  );\n\n  const clearPan = useCallback(() => {\n    ref.current = {\n      pointerDownId: null,\n      startTime: null,\n      prevOffsetX: 0,\n      prevOffsetY: 0\n    };\n  }, []);\n\n  const panProps = isDisabled\n    ? {}\n    : {\n        /** event handlers to spread on the target element. */\n        onPointerDown,\n        onPointerUp,\n        onPointerMove,\n        onPointerCancel: clearPan\n      };\n\n  return {\n    panProps\n  };\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nexport { usePan } from './usePan';\n"],"names":["useRef","useCallback"],"mappings":"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"}