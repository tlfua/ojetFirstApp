{"version":3,"file":"Submenu-e48dee68.js","sources":["../../src/UNSAFE_Menu/DropdownSubmenu.tsx","../../src/UNSAFE_Menu/SheetSubmenu.tsx","../../src/UNSAFE_Menu/Submenu.tsx"],"sourcesContent":["import { useCallback, useEffect, useMemo, useRef, useState } from 'preact/compat';\n\nimport { DirectionalExpandArrowIcon } from '../PRIVATE_ThemedIcons/DirectionalExpandArrowIcon';\nimport { useId } from '../hooks/UNSAFE_useId';\n\nimport { BaseMenuItem } from './MenuItem';\nimport { DropdownMenu } from './DropdownMenu';\nimport { useMenuContainerContext } from './useMenuContainerContext';\nimport { SubmenuProps } from './Submenu';\n\nexport const DropdownSubmenu = ({ label, children }: SubmenuProps) => {\n  //Id of the submenu that will be used to connect via aria-owns, menuItem with its submenu\n  const submenuId = useId();\n\n  const preProcessedMenuItemID = useId();\n  //MenuItem id\n  const menuItemId = useMemo(\n    () => `oj-menu-item-${preProcessedMenuItemID}`,\n    [preProcessedMenuItemID]\n  );\n\n  const { changeKey, currentKey } = useMenuContainerContext();\n\n  const submenuMenuItemRef = useRef<HTMLAnchorElement | null>(null);\n  const dropdownSubmenuRef = useRef<HTMLDivElement | null>(null);\n\n  const [isOpen, setIsOpen] = useState(false);\n\n  const [currentFocus, setCurrentFocus] = useState<'menu' | 'firstItem' | 'none'>('none');\n\n  useEffect(() => {\n    if (menuItemId !== currentKey) {\n      setIsOpen(false);\n    }\n  }, [currentKey, menuItemId]);\n\n  //This function is used when pressing submenuitem and hovering over it\n  const openSubmenuAction = useCallback((e: Event) => {\n    submenuMenuItemRef.current?.focus();\n    //If not click/touch we set the focus on the first item\n    setIsOpen(true);\n    if (e.type === 'keyup') {\n      setCurrentFocus('firstItem');\n    } else {\n      setCurrentFocus('none');\n    }\n  }, []);\n\n  //TODO: There is a bug in a Icon, once that bug is solved we have to check this again. JET-56980\n  const hoverStatus = useRef<{ recentClose: boolean; pendingUnhover: boolean }>({\n    recentClose: false,\n    pendingUnhover: false\n  });\n\n  return (\n    <>\n      <BaseMenuItem\n        id={menuItemId}\n        submenuId={submenuId}\n        ref={submenuMenuItemRef}\n        label={label}\n        endIcon={<DirectionalExpandArrowIcon></DirectionalExpandArrowIcon>}\n        type=\"submenu\"\n        role=\"menuitem\"\n        onAction={openSubmenuAction}\n        hoverInfo={{\n          //Specific hover events of submenuItem\n          hoverProps: {\n            onMouseEnter: (e: MouseEvent) => {\n              openSubmenuAction(e);\n            }\n          },\n          hoverStatus\n        }}\n        //Open submenu using right/left key\n        openSubmenu={() => {\n          setIsOpen(true);\n          setCurrentFocus('firstItem');\n        }}\n        submenuRef={dropdownSubmenuRef}\n        isSubmenuOpen={isOpen}></BaseMenuItem>\n      {isOpen ? (\n        <DropdownMenu\n          menuLevel=\"sub\"\n          menuId={submenuId}\n          //Close submenu with left/right key\n          closeSubmenu={() => {\n            hoverStatus.current.recentClose = true;\n            changeKey({ key: currentKey, reason: 'keyboard' });\n            setTimeout(() => {\n              hoverStatus.current.recentClose = false;\n            }, HOVER_SHIFT_TIMEOUT);\n            setIsOpen(false);\n            //CurrentKey can be the same as submenuItem, because of that we explicitly focus it\n            submenuMenuItemRef.current?.focus();\n          }}\n          /*For now we are exposing ref if this is exposed at some point we would look for other\n            mechanisms to use this ref */\n          ref={dropdownSubmenuRef}\n          anchorRef={submenuMenuItemRef}\n          defaultPlacement=\"end-top\"\n          currentFocus={currentFocus}\n          offsetValue={{\n            mainAxis: -8, //TODO: need to figure out how to make this themable.\n            crossAxis: -8\n          }}\n          flipOptions={{\n            crossAxis: true,\n            mainAxis: true,\n            fallbackPlacements: ['start-top', 'end-bottom', 'start-bottom']\n          }}>\n          {children}\n        </DropdownMenu>\n      ) : null}\n    </>\n  );\n};\n\nconst HOVER_SHIFT_TIMEOUT = 100;\n","import { useCallback, useEffect, useRef, useState } from 'preact/hooks';\n\nimport { useId } from '../hooks/UNSAFE_useId';\nimport { DirectionalCollapseArrowIcon } from '../PRIVATE_ThemedIcons/DirectionalCollapseArrowIcon';\nimport { DirectionalExpandArrowIcon } from '../PRIVATE_ThemedIcons/DirectionalExpandArrowIcon';\n\nimport { BaseMenuItem } from './MenuItem';\nimport { SheetMenu } from './SheetMenu';\nimport { useMenuContainerContext } from './useMenuContainerContext';\nimport { SubmenuProps } from './Submenu';\n\nexport const SheetSubmenu = ({ label, children }: SubmenuProps) => {\n  const submenuId = useId();\n  const submenuItemId = useId();\n  const submenuTitleId = useId();\n\n  const submenuMenuItemRef = useRef<HTMLAnchorElement | null>(null);\n\n  const [isOpen, setIsOpen] = useState(false);\n\n  const [initialFocus, setInitialFocus] = useState<'menu' | 'secondItem'>('menu');\n\n  const { menuContainerRef, changeKey } = useMenuContainerContext();\n  /* We have to wrap opening display change inside a useEffect to avoid flashy effect when opening submenu*/\n  useEffect(() => {\n    if (isOpen) {\n      if (menuContainerRef.current) {\n        /*Menu hidden instead of unmounted for two main reasons:\n      1. Children need to be updated even if menu is present.\n      2. We can't unmount parent since all the submenus are children of main menuContainer*/\n        menuContainerRef.current.style.display = 'none';\n      }\n    }\n  }, [isOpen, menuContainerRef]);\n\n  const openSubmenuDirectional = useCallback(() => {\n    setIsOpen(true);\n    setInitialFocus('secondItem');\n  }, []);\n\n  const openSubmenuAction = useCallback((e: Event) => {\n    //If the submenu is open using keyboard focus has to go to second item(first is the title), if not to the menu Container\n    setIsOpen(true);\n    if (e.type === 'keyup') {\n      setInitialFocus('secondItem');\n    } else {\n      setInitialFocus('menu');\n    }\n  }, []);\n\n  const returnFocusToSubmenuItem = useCallback(() => {\n    changeKey({ key: submenuItemId, reason: 'keyboard' });\n    submenuMenuItemRef.current?.focus();\n  }, [changeKey, submenuItemId, submenuMenuItemRef]);\n\n  /* No need to \"save\" these functions with useCallback */\n  const closeSubmenu = () => {\n    setIsOpen(false);\n    if (menuContainerRef.current) {\n      //Submenu is unmounted and prev menu is visible again.\n      /*Dom manipulation is kind of dirty. Have to check for new approaches. JET-57239 */\n      menuContainerRef.current.style.display = 'block';\n    }\n  };\n\n  const closeSubmenuPressingTitleItem = (e: Event) => {\n    closeSubmenu();\n    //If the submenu is closed using keyboard focus has to go to submenuItem that opened submenu, if not to the menu Container\n    if (e.type === 'keyup') {\n      returnFocusToSubmenuItem();\n    } else {\n      changeKey({ key: undefined, reason: 'click' });\n      menuContainerRef.current?.focus();\n    }\n  };\n\n  const closeDirectional = () => {\n    closeSubmenu();\n    returnFocusToSubmenuItem();\n  };\n\n  return (\n    <>\n      <BaseMenuItem\n        id={submenuItemId}\n        submenuId={submenuId}\n        ref={submenuMenuItemRef}\n        label={label}\n        endIcon={<DirectionalExpandArrowIcon></DirectionalExpandArrowIcon>}\n        type=\"submenu\"\n        role=\"menuitem\"\n        onAction={openSubmenuAction}\n        openSubmenu={openSubmenuDirectional}\n        isSubmenuOpen={isOpen}></BaseMenuItem>\n      {!isOpen ? null : (\n        <SheetMenu\n          menuId={submenuId}\n          closeSubmenu={closeDirectional}\n          menuLevel=\"sub\"\n          anchorRef={submenuMenuItemRef}\n          //TODO: We need to check if this initial focus is desired based on some W3C specs\n          currentFocus={initialFocus}>\n          <BaseMenuItem\n            id={submenuTitleId}\n            menuItemLabelWeight=\"bold\"\n            role=\"menuitem\"\n            type=\"submenu\"\n            startIcon={<DirectionalCollapseArrowIcon></DirectionalCollapseArrowIcon>}\n            onAction={closeSubmenuPressingTitleItem}\n            label={label}></BaseMenuItem>\n          {children}\n        </SheetMenu>\n      )}\n    </>\n  );\n};\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { ComponentChildren } from 'preact';\n\nimport { DropdownSubmenu } from './DropdownSubmenu';\nimport { SheetSubmenu } from './SheetSubmenu';\nimport { useMenuContext } from './useMenuContext';\n\nexport type SubmenuProps = {\n  /**\n   * Set of menu groups or menu items that submenumenu will hold.Even though you could pass other type of children,\n   * is strongly recommended to use MenuItem, menu groups or components that return this type of components\n   * since passing other type of components children produces not desirable behaviors.\n   */\n  children?: ComponentChildren;\n\n  /**\n   *  Determines submenu text.\n   */\n  label: string;\n};\n\n/*Submenu behaves differently depending the device */\nexport const Submenu = ({ label, children }: SubmenuProps) => {\n  const { isMobile } = useMenuContext();\n  return (\n    <>\n      {isMobile ? (\n        <SheetSubmenu label={label}>{children}</SheetSubmenu>\n      ) : (\n        <DropdownSubmenu label={label}>{children}</DropdownSubmenu>\n      )}\n    </>\n  );\n};\n"],"names":["_jsxs","_Fragment","_jsx","useRef","useState","useEffect","useCallback"],"mappings":"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"}