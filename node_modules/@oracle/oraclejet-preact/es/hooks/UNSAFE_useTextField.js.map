{"version":3,"file":"UNSAFE_useTextField.js","sources":["../../../src/hooks/UNSAFE_useTextField/useTextField.ts"],"sourcesContent":["import { ComponentProps } from 'preact';\nimport { Label } from '../../UNSAFE_Label';\nimport { TextField } from '../../UNSAFE_TextField';\nimport { InlineUserAssistance, UserAssistanceDensityType } from '../../UNSAFE_UserAssistance';\nimport { useMessageSeverity } from '../PRIVATE_useMessageSeverity';\nimport { merge } from '../../utils/UNSAFE_stringUtils';\nimport { useFocusWithin } from '../UNSAFE_useFocusWithin';\nimport { useFormFieldContextProps } from '../UNSAFE_useFormFieldContextProps';\nimport { useId } from '../UNSAFE_useId';\nimport { AriaAttributesSignalExcluded } from '../../utils/UNSAFE_attributeUtils';\n\ntype InlineUserAssistanceProps = ComponentProps<typeof InlineUserAssistance>;\ntype PickedUserAssistanceProps = Pick<InlineUserAssistanceProps, 'messages'>;\n\ntype UseTextFieldProps<V> = PickedUserAssistanceProps & {\n  ariaDescribedBy?: string;\n  contentVariant?: 'input' | 'textarea';\n  helpSourceLink?: string;\n  helpSourceText?: string;\n  isDisabled?: boolean;\n  isFocused?: boolean;\n  isLoading?: boolean;\n  isReadonly?: boolean;\n  isRequiredShown?: boolean;\n  labelEdge?: ComponentProps<typeof TextField>['labelEdge'] | 'none';\n  styleVariant?: 'default' | 'embedded';\n  userAssistanceDensity?: UserAssistanceDensityType;\n  value?: V;\n};\n\n/**\n * A custom hook to determine the props for a component that renders\n * a text field\n */\nexport function useTextField<V>({\n  ariaDescribedBy,\n  contentVariant,\n  helpSourceLink,\n  helpSourceText,\n  isDisabled,\n  isFocused,\n  isLoading,\n  isReadonly,\n  isRequiredShown,\n  labelEdge,\n  messages,\n  styleVariant,\n  userAssistanceDensity,\n  value\n}: UseTextFieldProps<V>) {\n  const baseId = useId();\n  const labelId = labelEdge !== 'none' ? `${baseId}-label` : undefined;\n  const inputId = !isReadonly ? `${baseId}-input` : undefined;\n  const uaId = !(isDisabled || isReadonly) ? `${baseId}-ua` : undefined;\n  const helpIconId = userAssistanceDensity === 'compact' ? `${baseId}-helpIcon` : undefined;\n\n  const { focusProps, isFocused: isInputFocused } = useFocusWithin({ isDisabled });\n  const hasValue = value !== undefined && (typeof value !== 'string' || value !== '');\n\n  // Create the form field context\n  const formFieldContext = useFormFieldContextProps({\n    hasValue,\n    isDisabled,\n    isFocused,\n    isInputFocused,\n    isLoading,\n    isReadonly,\n    value\n  });\n\n  // Determine the highest severity from the messages\n  const messageSeverity = useMessageSeverity(messages);\n\n  // Determine the label variant\n  const labelVariant: ComponentProps<typeof Label>['variant'] =\n    labelEdge === 'inside'\n      ? messageSeverity === 'error'\n        ? 'insideError'\n        : messageSeverity === 'warning'\n        ? 'insideWarning'\n        : labelEdge\n      : labelEdge !== 'none'\n      ? labelEdge\n      : undefined;\n\n  return {\n    baseId,\n    formFieldContext,\n    inputProps: {\n      id: inputId,\n      'aria-describedby': merge([helpIconId, uaId, ariaDescribedBy]),\n      'aria-invalid':\n        messageSeverity === 'error'\n          ? 'true'\n          : (undefined as AriaAttributesSignalExcluded['aria-invalid']),\n      variant: styleVariant,\n      onBlur: focusProps?.onfocusout,\n      onFocus: focusProps?.onfocusin\n    },\n    labelProps: {\n      forId: inputId,\n      helpIconId,\n      helpSourceLink,\n      helpSourceText,\n      id: labelId,\n      isRequiredShown,\n      userAssistanceDensity,\n      variant: labelVariant\n    },\n    textFieldProps: {\n      contentVariant,\n      statusVariant: /error|warning/.test(messageSeverity ?? '')\n        ? (messageSeverity as 'error' | 'warning')\n        : undefined,\n      styleVariant\n    },\n    userAssistanceProps: {\n      id: uaId\n    }\n  };\n}\n"],"names":[],"mappings":";;;;;;;;;;AA8BA;;;AAGG;AACa,SAAA,YAAY,CAAI,EAC9B,eAAe,EACf,cAAc,EACd,cAAc,EACd,cAAc,EACd,UAAU,EACV,SAAS,EACT,SAAS,EACT,UAAU,EACV,eAAe,EACf,SAAS,EACT,QAAQ,EACR,YAAY,EACZ,qBAAqB,EACrB,KAAK,EACgB,EAAA;AACrB,IAAA,MAAM,MAAM,GAAG,KAAK,EAAE,CAAC;AACvB,IAAA,MAAM,OAAO,GAAG,SAAS,KAAK,MAAM,GAAG,CAAA,EAAG,MAAM,CAAQ,MAAA,CAAA,GAAG,SAAS,CAAC;AACrE,IAAA,MAAM,OAAO,GAAG,CAAC,UAAU,GAAG,CAAG,EAAA,MAAM,CAAQ,MAAA,CAAA,GAAG,SAAS,CAAC;AAC5D,IAAA,MAAM,IAAI,GAAG,EAAE,UAAU,IAAI,UAAU,CAAC,GAAG,GAAG,MAAM,CAAA,GAAA,CAAK,GAAG,SAAS,CAAC;AACtE,IAAA,MAAM,UAAU,GAAG,qBAAqB,KAAK,SAAS,GAAG,CAAA,EAAG,MAAM,CAAW,SAAA,CAAA,GAAG,SAAS,CAAC;AAE1F,IAAA,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,cAAc,EAAE,GAAG,cAAc,CAAC,EAAE,UAAU,EAAE,CAAC,CAAC;AACjF,IAAA,MAAM,QAAQ,GAAG,KAAK,KAAK,SAAS,KAAK,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,KAAK,EAAE,CAAC,CAAC;;IAGpF,MAAM,gBAAgB,GAAG,wBAAwB,CAAC;QAChD,QAAQ;QACR,UAAU;QACV,SAAS;QACT,cAAc;QACd,SAAS;QACT,UAAU;QACV,KAAK;AACN,KAAA,CAAC,CAAC;;AAGH,IAAA,MAAM,eAAe,GAAG,kBAAkB,CAAC,QAAQ,CAAC,CAAC;;AAGrD,IAAA,MAAM,YAAY,GAChB,SAAS,KAAK,QAAQ;UAClB,eAAe,KAAK,OAAO;AAC3B,cAAE,aAAa;cACb,eAAe,KAAK,SAAS;AAC/B,kBAAE,eAAe;AACjB,kBAAE,SAAS;UACX,SAAS,KAAK,MAAM;AACtB,cAAE,SAAS;cACT,SAAS,CAAC;IAEhB,OAAO;QACL,MAAM;QACN,gBAAgB;AAChB,QAAA,UAAU,EAAE;AACV,YAAA,EAAE,EAAE,OAAO;YACX,kBAAkB,EAAE,KAAK,CAAC,CAAC,UAAU,EAAE,IAAI,EAAE,eAAe,CAAC,CAAC;YAC9D,cAAc,EACZ,eAAe,KAAK,OAAO;AACzB,kBAAE,MAAM;AACR,kBAAG,SAA0D;AACjE,YAAA,OAAO,EAAE,YAAY;YACrB,MAAM,EAAE,UAAU,EAAE,UAAU;YAC9B,OAAO,EAAE,UAAU,EAAE,SAAS;AAC/B,SAAA;AACD,QAAA,UAAU,EAAE;AACV,YAAA,KAAK,EAAE,OAAO;YACd,UAAU;YACV,cAAc;YACd,cAAc;AACd,YAAA,EAAE,EAAE,OAAO;YACX,eAAe;YACf,qBAAqB;AACrB,YAAA,OAAO,EAAE,YAAY;AACtB,SAAA;AACD,QAAA,cAAc,EAAE;YACd,cAAc;YACd,aAAa,EAAE,eAAe,CAAC,IAAI,CAAC,eAAe,IAAI,EAAE,CAAC;AACxD,kBAAG,eAAuC;AAC1C,kBAAE,SAAS;YACb,YAAY;AACb,SAAA;AACD,QAAA,mBAAmB,EAAE;AACnB,YAAA,EAAE,EAAE,IAAI;AACT,SAAA;KACF,CAAC;AACJ;;;;"}