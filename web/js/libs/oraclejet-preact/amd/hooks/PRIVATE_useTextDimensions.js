define(['exports', 'preact/jsx-runtime', 'preact/hooks', '../utils/PRIVATE_clientHints', '../clientHints-ff5d5d13'], (function(t,e,n,r,a){"use strict";const i={canvas:{},htmlSvg:{},htmlCanvas:{},svg:{}};let o={fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",fontSize:"medium",lineHeight:"normal",fontFamily:"",letterSpacing:"normal",wordSpacing:"normal",fontVariantNumeric:"normal"};const s=new Set(["normal","small-caps"]),c=new Set(["normal","ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded","ultra-expanded"]),u="MW",f=t=>t?{...o,...t}:{...o},l=t=>{const{fontStyle:e,fontVariant:n,fontWeight:r,fontStretch:a,fontSize:i,lineHeight:o,fontFamily:s}=t;return`${e} ${n} ${r} ${a} ${Number.isNaN(Number(i))?i:`${i}px`}/${o} ${s}`},h=(t,e)=>t+l(e)+e.letterSpacing+e.wordSpacing+e.fontVariantNumeric,d=t=>"normal"===t||"0px"===t,g=(t,e,n)=>{const r=f(n),a=h(e,r),o=i.canvas[a];if(o)return o;const s=l(r);t.font=s,t.letterSpacing="0px",t.letterSpacing=r.letterSpacing,t.wordSpacing="0px",t.wordSpacing=r.wordSpacing;const c=t.measureText(e),u={x:0,y:-c.fontBoundingBoxAscent,width:c.width,height:c.fontBoundingBoxAscent+c.fontBoundingBoxDescent};return i.canvas[a]=u,u},m=(t,e,n)=>{const r=f(n),a=h(e,r),o=i.svg[a];if(o)return o;const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("font-style",r.fontStyle),s.setAttribute("font-variant",r.fontVariant),s.setAttribute("font-weight",r.fontWeight),s.setAttribute("font-stretch",r.fontStretch),s.setAttribute("font-size",r.fontSize),s.setAttribute("font-family",r.fontFamily),s.setAttribute("letter-spacing",r.letterSpacing),s.setAttribute("word-spacing",r.wordSpacing),s.style.fontVariantNumeric=r.fontVariantNumeric,s.textContent=e,t.appendChild(s);const c=s.getBBox(),u={x:c.x,y:c.y,width:c.width,height:c.height};return t.innerHTML="",i.svg[a]=u,u},p=(t,e,n,r)=>{const a=f(r),o=h(n,a),s="svg"===e.backend?i.htmlSvg:i.htmlCanvas,c=s[o];if(c)return c;const{width:d,height:p}=((t,e,n)=>{const r=f(n),a=l(r),i=document.createElement("span");i.style.font=a,i.style.whiteSpace="nowrap",i.style.letterSpacing=r.letterSpacing,i.style.wordSpacing=r.wordSpacing,i.style.fontVariantNumeric=r.fontVariantNumeric,i.textContent=e,t.appendChild(i);const o={width:i.offsetWidth,height:i.offsetHeight};return t.innerHTML="",o})(t,n,r),{x:S,y:x}=((t,e)=>{let n;switch(t.backend){case"svg":n=m(t.container,u,e);break;case"canvas":n=g(t.ctx,u,e)}return{x:n.x,y:n.y,width:n.width/2,height:n.height}})(e,r),w={x:S,y:x,width:d,height:p};return s[o]=w,w},S=a.getClientHints().browser;t.useTextDimensions=({backend:t="auto"}={})=>{const r=n.useRef(null),a=n.useRef(null),i=n.useRef(null),[u,l]=n.useState(),h=n.useMemo((()=>{const n=e.jsx("canvas",{ref:r,style:{display:"none"}}),s=e.jsx("div",{ref:a}),c=e.jsx("svg",{ref:i,style:{display:"block",width:"0px",height:"0px"}}),u={canvas:{refs:[r],measureContent:n,measureFunction:(t,e)=>{const n=r.current,a=n?.getContext("2d");return n&&a?g(a,t,e):{x:-1,y:-1,width:-1,height:-1}}},htmlSvg:{refs:[a,i],measureContent:e.jsxs("div",{children:[s,c]}),measureFunction:(t,e)=>a.current&&i.current?p(a.current,{backend:"svg",container:i.current},t,e):{x:-1,y:-1,width:-1,height:-1}},htmlCanvas:{refs:[a,r],measureContent:e.jsxs("div",{children:[s,n]}),measureFunction:(t,e)=>{const n=r.current,i=n?.getContext("2d");return a.current&&n&&i?p(a.current,{backend:"canvas",ctx:i},t,e):{x:-1,y:-1,width:-1,height:-1}}},svg:{refs:[i],measureContent:c,measureFunction:(t,e)=>i.current?m(i.current,t,e):{x:-1,y:-1,width:-1,height:-1}}};return"auto"===t?{refs:[a,r],measureContent:e.jsxs("div",{children:[n,s,c]}),measureFunction:(t,e)=>{const n=((t,e)=>{if("unknown"===t)return"htmlSvg";const{letterSpacing:n,wordSpacing:r,fontVariantNumeric:a}=f(e),i=d(n),s=d(r),c="normal"===a,u=a===o.fontVariantNumeric;if(i&&s&&c&&u)return"canvas";switch(t){case"firefox":default:return"htmlSvg";case"safari":case"chrome":case"edge":return i&&s&&u?"canvas":"htmlCanvas"}})(S,e);return u[n].measureFunction(t,e)}}:u[t]}),[t]);return n.useLayoutEffect((()=>{h.refs[0].current&&((t=>{const e=getComputedStyle(t);o={fontStyle:e.fontStyle,fontVariant:e.fontVariantCaps,fontWeight:e.fontWeight,fontStretch:e.fontStretch,fontSize:e.fontSize,lineHeight:e.lineHeight,fontFamily:e.fontFamily,letterSpacing:e.letterSpacing,wordSpacing:e.wordSpacing,fontVariantNumeric:e.fontVariantNumeric},o.fontVariant&&s.has(o.fontVariant)||(o.fontVariant="normal"),o.fontStretch&&c.has(o.fontStretch)||(o.fontStretch="normal")})(h.refs[0].current),document.fonts.ready.then((()=>{l((()=>h.measureFunction))})))}),[h]),{textMeasureContent:h.measureContent,getTextDimensions:u}},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=PRIVATE_useTextDimensions.js.map
