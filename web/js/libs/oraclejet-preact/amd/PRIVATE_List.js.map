{"version":3,"file":"PRIVATE_List.js","sources":["../../src/PRIVATE_List/ListGroupHeader.tsx","../../src/PRIVATE_List/GroupLoadingIndicator.tsx","../../src/PRIVATE_List/ListUtils.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { ComponentChildren } from 'preact';\nimport { useState } from 'preact/hooks';\nimport { classNames } from '../utils/UNSAFE_classNames';\nimport { Keys, containsKey } from '../utils/UNSAFE_keys';\nimport { useId } from '../hooks/UNSAFE_useId';\nimport { ToggleDetail } from '../UNSAFE_Collection';\nimport { ITEM_STYLE_CLASS } from '../PRIVATE_List/ListItem';\nimport { useViewportIntersect, ViewportConfig } from '../hooks/UNSAFE_useViewportIntersect';\nimport { TabbableModeContext } from '../hooks/UNSAFE_useTabbableMode';\nimport { useComponentTheme } from '../hooks/UNSAFE_useComponentTheme';\nimport { useInteractionStyle } from '../hooks/UNSAFE_useInteractionStyle';\nimport { mergeInterpolations } from '../utils/UNSAFE_mergeInterpolations';\nimport { flexitemInterpolations } from '../utils/UNSAFE_interpolations/flexitem';\nimport type { FlexitemProps } from '../utils/UNSAFE_interpolations/flexitem';\nimport { GroupedListStyles } from 'src/UNSAFE_GroupedList/themes/GroupedListStyles.css';\nimport { listGroupHeaderMultiVariantStyles } from './themes/ListStyles.css';\nimport { GroupedListRedwoodTheme } from '../UNSAFE_GroupedList/themes/redwood/GroupedListTheme';\n\n// default style class for items in ListView\nexport const GROUP_STYLE_CLASS = 'oj-c-listview-group';\nexport const GROUP_SELECTOR = '.' + GROUP_STYLE_CLASS;\nexport const STICKY_STYLE_CLASS = 'oj-c-listview-sticky';\n\n/**\n * Props for the ListViewItem Component\n */\nexport type Props<K> = {\n  children: ComponentChildren;\n  itemKey: K;\n  itemIndex: number;\n  itemDepth: number;\n  isFocused: boolean;\n  isFocusRingVisible: boolean;\n  isActive: boolean;\n  isGridlineVisible: boolean;\n  isExpandable: boolean;\n  expandedKeys: Keys<K>;\n  ariaDescribedBy?: string;\n  onToggle?: (detail: ToggleDetail<K>) => void;\n  viewportConfig?: ViewportConfig;\n};\n\n/**\n * The internal component used to render a group header in ExpandableList and GroupedList.\n */\nexport function ListGroupHeader<K extends string | number>({\n  ariaDescribedBy,\n  children,\n  itemKey,\n  itemIndex,\n  itemDepth,\n  isFocused,\n  isFocusRingVisible,\n  isActive,\n  isGridlineVisible,\n  isExpandable,\n  expandedKeys,\n  viewportConfig\n}: Props<K>) {\n  const [isStuck, setStuck] = useState(false);\n\n  const { classes: groupedListThemeClasses, styles: groupedListStyles } = useComponentTheme<\n    never,\n    GroupedListStyles\n  >(GroupedListRedwoodTheme);\n\n  const { interactionProps, applyHoverStyle, applyPseudoHoverStyle, applyActiveStyle } =\n    useInteractionStyle();\n\n  const variantClasses = listGroupHeaderMultiVariantStyles({\n    expandable: isExpandable ? 'isExpandable' : 'notExpandable',\n    needsEventsHover: applyHoverStyle ? 'isNeedsEventsHover' : 'notNeedsEventsHover',\n    pseudoHover: applyPseudoHoverStyle ? 'isPseudoHover' : 'notPseudoHover',\n    active: applyActiveStyle || isActive ? 'isActive' : 'notActive',\n    focusRingVisible:\n      isFocusRingVisible && isFocused ? 'isFocusRingVisible' : 'notFocusRingVisible',\n    gridlineTop: itemIndex > 0 ? 'visible' : 'hidden',\n    gridlineBottom: isGridlineVisible ? 'visible' : 'hidden'\n  });\n\n  const baseClasses = [ITEM_STYLE_CLASS, GROUP_STYLE_CLASS, variantClasses];\n  if (isStuck) {\n    baseClasses.push(groupedListThemeClasses);\n    baseClasses.push(groupedListStyles.stuckHeader);\n    baseClasses.push(STICKY_STYLE_CLASS);\n  }\n\n  const classes = classNames(baseClasses);\n  const styleInterpolations = mergeInterpolations<FlexitemProps>([\n    ...Object.values(flexitemInterpolations)\n  ]);\n  const { class: cls, ...cellStyles } = styleInterpolations({\n    alignSelf: 'center',\n    flex: '1 0 auto'\n  });\n\n  useViewportIntersect(\n    {\n      scroller: () => {\n        if (isExpandable) {\n          return null;\n        }\n        if (viewportConfig == null) {\n          return document.body;\n        }\n        return viewportConfig.scroller();\n      }\n    },\n    0,\n    1,\n    '[data-oj-key=' + itemKey + ']',\n    () => {\n      setStuck(false);\n    },\n    (entry: IntersectionObserverEntry) => {\n      if (entry.boundingClientRect.y !== entry.intersectionRect.y) {\n        setStuck(true);\n      }\n    }\n  );\n  return (\n    <div\n      id={useId()}\n      role=\"row\"\n      aria-rowindex={itemIndex + 1}\n      aria-level={isNaN(itemDepth) ? undefined : itemDepth + 1}\n      data-oj-key={itemKey}\n      class={classes}\n      {...(typeof itemKey === 'number' && { 'data-oj-key-type': 'number' })}\n      {...interactionProps}>\n      <div\n        id={useId()}\n        role=\"gridcell\"\n        aria-describedby={ariaDescribedBy}\n        aria-colindex={1}\n        aria-expanded={containsKey(expandedKeys, itemKey)}\n        style={cellStyles}>\n        <TabbableModeContext.Provider value={{ isTabbable: false }}>\n          {children}\n        </TabbableModeContext.Provider>\n      </div>\n    </div>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { Flex } from '../UNSAFE_Flex';\nimport { Skeleton } from '../UNSAFE_Skeleton';\nimport { SkeletonContainer } from './SkeletonContainer';\n\nexport const GroupLoadingIndicator = () => (\n  <SkeletonContainer minimumCount={3}>\n    {(index: number) => {\n      const padding = { paddingLeft: index * 10 + 'px' };\n      return (\n        <Flex height=\"12x\" align=\"center\">\n          <span style={padding}></span>\n          <Skeleton height=\"4x\" />\n        </Flex>\n      );\n    }}\n  </SkeletonContainer>\n);\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { FlattenedDataState } from '../UNSAFE_Collection';\nimport { Keys } from '../utils/UNSAFE_keys';\n\n/**\n * Helper function to only include keys of leaf items.\n */\nexport const excludeGroup = <K, D>(data: FlattenedDataState<K, D>, keys: Keys<K>) => {\n  if (!keys.all) {\n    const groups = data.data\n      .filter((dataMetadata) => {\n        return !dataMetadata.metadata.isLeaf;\n      })\n      .map((dataMetadata) => {\n        return dataMetadata.metadata.key;\n      });\n    const leafOnly = Array.from(keys.keys.values()).filter((key: K) => {\n      return !groups.includes(key);\n    });\n    return { ...keys, keys: new Set(leafOnly) };\n  }\n  return keys;\n};\n"],"names":["GROUP_STYLE_CLASS","GROUP_SELECTOR","STICKY_STYLE_CLASS","_jsx","jsx","SkeletonContainer","minimumCount","index","padding","paddingLeft","_jsxs","jsxs","Flex","height","align","children","style","Skeleton","ariaDescribedBy","itemKey","itemIndex","itemDepth","isFocused","isFocusRingVisible","isActive","isGridlineVisible","isExpandable","expandedKeys","viewportConfig","isStuck","setStuck","useState","classes","groupedListThemeClasses","styles","groupedListStyles","useComponentTheme","GroupedListRedwoodTheme","interactionProps","applyHoverStyle","applyPseudoHoverStyle","applyActiveStyle","useInteractionStyle","variantClasses","listGroupHeaderMultiVariantStyles","expandable","needsEventsHover","pseudoHover","active","focusRingVisible","gridlineTop","gridlineBottom","baseClasses","ITEM_STYLE_CLASS","push","stuckHeader","classNames","styleInterpolations","mergeInterpolations","Object","values","flexitemInterpolations","class","cls","cellStyles","alignSelf","flex","useViewportIntersect","scroller","document","body","entry","boundingClientRect","y","intersectionRect","id","useId","role","isNaN","undefined","containsKey","TabbableModeContext","Provider","value","isTabbable","data","keys","all","groups","filter","dataMetadata","metadata","isLeaf","map","key","leafOnly","Array","from","includes","Set"],"mappings":"mwJA0BO,MAAMA,GAAoB,sBACpBC,GAAiB,IAAMD,GACvBE,GAAqB,yHCjBG,IACnCC,EAAAC,IAACC,oBAAiB,CAACC,aAAc,WAC7BC,IACA,MAAMC,EAAU,CAAEC,YAAqB,GAARF,EAAa,MAC5C,OACEG,EAACC,KAAAC,OAAK,CAAAC,OAAO,MAAMC,MAAM,SACvBC,SAAA,CAAAZ,MAAA,OAAA,CAAMa,MAAOR,IACbL,MAACc,EAAAA,SAAQ,CAACJ,OAAO,SAEnB,sBDgCF,UAAqDK,gBACzDA,EAAeH,SACfA,EAAQI,QACRA,EAAOC,UACPA,EAASC,UACTA,EAASC,UACTA,EAASC,mBACTA,EAAkBC,SAClBA,EAAQC,kBACRA,EAAiBC,aACjBA,EAAYC,aACZA,EAAYC,eACZA,IAEA,MAAOC,EAASC,GAAYC,EAAQA,UAAC,IAE7BC,QAASC,EAAyBC,OAAQC,GAAsBC,EAAAA,kBAGtEC,EAAAA,0BAEIC,iBAAEA,EAAgBC,gBAAEA,EAAeC,sBAAEA,EAAqBC,iBAAEA,GAChEC,EAAAA,sBAEIC,EAAiBC,EAAAA,kCAAkC,CACvDC,WAAYnB,EAAe,eAAiB,gBAC5CoB,iBAAkBP,EAAkB,qBAAuB,sBAC3DQ,YAAaP,EAAwB,gBAAkB,iBACvDQ,OAAQP,GAAoBjB,EAAW,WAAa,YACpDyB,iBACE1B,GAAsBD,EAAY,qBAAuB,sBAC3D4B,YAAa9B,EAAY,EAAI,UAAY,SACzC+B,eAAgB1B,EAAoB,UAAY,WAG5C2B,EAAc,CAACC,EAAAA,iBAAkBrD,GAAmB2C,GACtDd,IACFuB,EAAYE,KAAKrB,GACjBmB,EAAYE,KAAKnB,EAAkBoB,aACnCH,EAAYE,KAAKpD,KAGnB,MAAM8B,EAAUwB,aAAWJ,GACrBK,EAAsBC,EAAAA,oBAAmC,IAC1DC,OAAOC,OAAOC,6BAEXC,MAAOC,KAAQC,GAAeP,EAAoB,CACxDQ,UAAW,SACXC,KAAM,aA2BR,OAxBAC,uBACE,CACEC,SAAU,IACJ1C,EACK,KAEa,MAAlBE,EACKyC,SAASC,KAEX1C,EAAewC,YAG1B,EACA,EACA,gBAAkBjD,EAAU,KAC5B,KACEW,GAAS,EAAM,IAEhByC,IACKA,EAAMC,mBAAmBC,IAAMF,EAAMG,iBAAiBD,GACxD3C,GAAS,EACV,IAIH3B,aACEwE,GAAIC,EAAAA,QACJC,KAAK,sBACUzD,EAAY,EACf,aAAA0D,MAAMzD,QAAa0D,EAAY1D,EAAY,EAC1C,cAAAF,EACb2C,MAAO9B,KACiB,iBAAZb,GAAwB,CAAE,mBAAoB,aACtDmB,WACJnC,MACE,MAAA,CAAAwE,GAAIC,EAAKA,QACTC,KAAK,WACa,mBAAA3D,kBACH,EAAC,gBACD8D,EAAAA,YAAYrD,EAAcR,GACzCH,MAAOgD,EACPjD,SAAAZ,EAAAC,IAAC6E,EAAmBA,oBAACC,UAASC,MAAO,CAAEC,YAAY,GAAOrE,SACvDA,OAKX,yCEzI4B,CAAOsE,EAAgCC,KACjE,IAAKA,EAAKC,IAAK,CACb,MAAMC,EAASH,EAAKA,KACjBI,QAAQC,IACCA,EAAaC,SAASC,SAE/BC,KAAKH,GACGA,EAAaC,SAASG,MAE3BC,EAAWC,MAAMC,KAAKX,EAAKA,KAAK1B,UAAU6B,QAAQK,IAC9CN,EAAOU,SAASJ,KAE1B,MAAO,IAAKR,EAAMA,KAAM,IAAIa,IAAIJ,GACjC,CACD,OAAOT,CAAI"}