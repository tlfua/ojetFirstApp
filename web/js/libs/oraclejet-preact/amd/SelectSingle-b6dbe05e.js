define(['exports', 'preact/jsx-runtime', 'preact', 'preact/compat', './hooks/UNSAFE_useFocusableTextField', './hooks/UNSAFE_useFormContext', './hooks/UNSAFE_useFormFieldContext', './hooks/UNSAFE_useLoadingIndicatorTimer', './hooks/UNSAFE_useTextField', './UNSAFE_Label', './UNSAFE_LiveRegion', './UNSAFE_TextField', './UNSAFE_UserAssistance', './PRIVATE_SelectCommon', 'preact/hooks', './utils/UNSAFE_mergeProps', './hooks/UNSAFE_useTranslationBundle', './Label-fab64746', './ReadonlyTextFieldInput-541a2315', './TextFieldInput-17f3ed29'], (function(e,o,s,n,i,t,a,r,l,d,c,u,p,h,m,f,v,F,x,w){"use strict";const b=n.forwardRef((({"aria-describedby":e,assistiveText:n,data:d,helpSourceLink:b,helpSourceText:y,isDisabled:A,isLoading:S,isReadonly:R,isRequired:g,isRequiredShown:E,itemText:D,label:T,labelEdge:C,labelStartWidth:k,messages:K,onCommit:L,onFilter:I,onLoadRange:U,placeholder:j,textAlign:P,userAssistanceDensity:_,valueItem:M,variant:N="default",virtualKeyboard:z},B)=>{const{isDisabled:O,isReadonly:H,labelEdge:V,labelStartWidth:q,textAlign:W,userAssistanceDensity:Y}=t.useFormContext(),$=A??O,Z=R??H,G=C??V,J=k??q,Q=P??W,X=_??Y,{enabledElementRef:ee,focusProps:oe,isFocused:se,readonlyElementRef:ne}=i.useFocusableTextField({isDisabled:$,isReadonly:Z,ref:B}),{collectionProps:ie,dropdownArrowEventHandlers:te,dropdownEventHandlers:ae,dropdownRef:re,inputEventHandlers:le,isDropdownAbove:de,isDropdownOpen:ce,isFocused:ue,isUserFiltering:pe,mainFieldRef:he,mouseProps:me,searchText:fe,userInput:ve}=function({data:e,inputRef:o,isDisabled:s,isFocused:n,isReadonly:i,onCommit:t,onFilter:a,valueItem:r}){const{currentRow:l,dropdownRef:d,handleDropdownArrowClick:c,handleDropdownAutoDismiss:u,handleDropdownPosition:p,handleInput:v,handleMainFieldKeyDown:F,handleMainFieldKeyUp:x,isDropdownAbove:w,isDropdownOpen:b,isFocused:y,isUserFiltering:A,mainFieldRef:S,onCurrentKeyChange:R,onMouseDown:g,searchText:E,selectedKeys:D,setCurrentRow:T,setDropdownOpen:C,setSelectedKeys:k,stopFiltering:K,userInput:L}=h.useSelectCommon({data:e,inputRef:o,isFocused:n,onFilter:a}),I=m.useRef(e),U=m.useRef(b),j=m.useRef(E),P=m.useCallback((e=>{t?.({value:e,previousValue:void 0!==r?r.key:void 0})}),[t,r]),_=m.useCallback((()=>{C(!1),k(new Set),P(void 0)}),[P]),M=m.useCallback((()=>!(!A||""!==L||void 0===r||(_(),0))),[_,A,L,r]);m.useEffect((()=>{y||M()}),[y]);const N=m.useCallback((()=>{o.current?.focus()}),[]),z=m.useCallback((()=>{d.current?.parentElement?.removeChild(d.current)}),[]),B=m.useCallback((e=>{b&&"keydown"===e?.type&&e.code===h.KEYS.TAB&&(void 0!==l&&void 0!==l.rowKey&&(k(new Set([l.rowKey])),P(l.rowKey)),N(),z())}),[l,N,b,P]),O=m.useCallback((o=>{if(!h.isControlOrFunctionKey(o))switch(o.code){case h.KEYS.TAB:!M()&&b&&null!=e&&e.data.length>0&&(void 0!==l&&void 0!==l.rowKey?(k(new Set([l.rowKey])),P(l.rowKey)):P(r?.key??void 0)),z(),C(!1);break;case h.KEYS.ENTER:!M()&&b&&null!=e&&e.data.length>0&&(C(!1),K(),void 0!==l&&void 0!==l.rowKey?(k(new Set([l.rowKey])),P(l.rowKey)):P(r?.key??void 0))}}),[M,l,e,b,P,r]);m.useEffect((()=>{k(void 0===r?void 0:new Set([r.key]))}),[r]);const H=m.useCallback((e=>{N(),C(!1),K();const o=e.context.metadata.key;k(new Set([o])),P(o)}),[N,P]);m.useEffect((()=>{e!==I.current&&b&&A&&null!=e&&0===e.offset&&e.data.length>0&&T({rowKey:void 0!==E&&E?.length>0?e.data[0].metadata.key:void 0})}),[e,b,A,E]),m.useEffect((()=>{b!==U.current&&(!b||A&&void 0!==E&&0!==E.length||T({rowKey:void 0}))}),[b,A,E]);const V=m.useMemo((()=>f.mergeProps({onAutoDismiss:u,onPosition:p},{onAutoDismiss:B})),[u,p,B]),q=m.useMemo((()=>f.mergeProps({onInput:v,onKeyDown:F,onKeyUp:x},{onKeyDown:O})),[F,v,x,O]);return m.useEffect((()=>{I.current=e,U.current=b,j.current=E})),{collectionProps:{currentKey:l.rowKey,onCurrentKeyChange:R,onItemAction:H,selectedKeys:D},dropdownArrowEventHandlers:{onClick:c},dropdownEventHandlers:V,dropdownRef:d,inputEventHandlers:q,inputRef:o,isDropdownAbove:w,isDropdownOpen:b,isFocused:y,isUserFiltering:A,mainFieldRef:S,mouseProps:s||i?{}:{onMouseDown:g},searchText:E,userInput:L}}({data:d,inputRef:ee,isDisabled:$,isFocused:se,isReadonly:Z,onCommit:L,onFilter:I,valueItem:M}),Fe=r.useLoadingIndicatorTimer(S??!1),{baseId:xe,formFieldContext:we,inputProps:be,labelProps:ye,textFieldProps:Ae,userAssistanceProps:Se}=l.useTextField({ariaDescribedBy:e,helpSourceLink:b,helpSourceText:y,isDisabled:$,isFocused:ue,isLoading:Fe,isReadonly:Z,isRequiredShown:E,labelEdge:G,messages:K,styleVariant:N,userAssistanceDensity:X,value:void 0!==M||void 0});we.hasValue=S||we.hasValue;const Re=`${xe}-dropdown`,ge=function(e,o){return m.useMemo((()=>void 0===o?"":h.renderItemText(o,e)??""),[o,e])}(D,M),Ee="none"!==G?o.jsx(F.Label,{...ye,children:T}):void 0,De={label:"none"!==G?Ee:void 0,labelEdge:"none"!==G?G:void 0,labelStartWidth:"none"!==G?J:void 0},Te="none"===G?T:void 0,Ce="efficient"===X||"reflow"===X?$||Z?"efficient"!==X?void 0:o.jsx(p.InlineUserAssistance,{userAssistanceDensity:X,...Se}):o.jsx(p.InlineUserAssistance,{assistiveText:n,fieldLabel:T,helpSourceLink:b,helpSourceText:y,messages:K,isRequiredShown:E,userAssistanceDensity:X,...Se}):void 0,ke="compact"===X?o.jsx(p.CompactUserAssistance,{anchorRef:he,messages:K,assistiveText:n,...Se}):void 0,Ke=v.useTranslationBundle("@oracle/oraclejet-preact");if(Z)return o.jsx(a.FormFieldContext.Provider,{value:we,children:o.jsx(u.ReadonlyTextField,{role:"presentation",compactUserAssistance:ke,inlineUserAssistance:Ce,onBlur:oe.onfocusout,onFocus:oe.onfocusin,ref:he,...De,children:o.jsx(x.ReadonlyTextFieldInput,{"aria-describedby":be["aria-describedby"],"aria-label":Te,"aria-labelledby":ye.id,as:"div",elementRef:ne,hasEmptyLabel:""===T&&"none"===G,hasInsideLabel:void 0!==T&&"inside"===G,textAlign:Q,value:ge})})});const Le=null!=d&&!h.isBeforeDataFetch(d),Ie=void 0!==Ee&&"inside"===G,Ue=ce&&Le?0===d?.totalSize?Ke.select_noMatchesFound():1===d?.totalSize?Ke.select_oneMatchFound():"exact"===d?.sizePrecision?Ke.select_sizeMatchesFound({TOTAL_SIZE:`${d?.totalSize}`}):Ke.select_sizeOrMoreMatchesFound({TOTAL_SIZE:`${d?.totalSize}`}):"",je=o.jsxs(s.Fragment,{children:[o.jsx(w.TextFieldInput,{"aria-autocomplete":"list","aria-controls":Re,"aria-expanded":ce,"aria-label":Te,autoComplete:"off",hasEmptyLabel:""===T&&"none"===G,hasInsideLabel:Ie,inputRef:ee,isRequired:g,...le,placeholder:j,role:"combobox",spellcheck:!1,textAlign:Q,type:h.isMobile()?"auto"===z?"search":z:void 0,value:pe?ve:ge,...be}),o.jsx(c.LiveRegion,{children:Ue})]}),Pe=o.jsx(h.DropdownArrow,{isDisabled:$,size:Ie?"md":"sm",...te}),_e=!ce||de||$||Z||!n&&!b||"efficient"!==X&&"reflow"!==X?void 0:o.jsx(h.DropdownUserAssistance,{assistiveText:n,fieldLabel:T,helpSourceLink:b,helpSourceText:y,userAssistanceDensity:X}),Me=Le&&0===d?.totalSize,Ne=Me?o.jsx(h.EmptyResults,{}):o.jsx(h.DefaultList,{...ie,"aria-label":T??"",currentItemVariant:"highlight",data:d,itemText:D,onLoadRange:U,searchText:pe?fe:void 0,selectionMode:"single"});return o.jsxs(s.Fragment,{children:[o.jsx(a.FormFieldContext.Provider,{value:we,children:o.jsx(u.TextField,{compactUserAssistance:ke,endContent:Fe?void 0:Pe,inlineUserAssistance:Ce,mainContent:je,mainFieldRef:he,onBlur:oe?.onfocusout,onFocus:oe?.onfocusin,...Ae,...De,...me})}),o.jsxs(h.Dropdown,{dropdownRef:re,id:Re,isOpen:ce&&void 0!==d&&(null===d||d.totalSize>0||h.isBeforeDataFetch(d)||Me),anchorRef:he,...ae,children:[o.jsx(h.DropdownList,{hasBottomGap:void 0===_e,isLoading:null===d,children:Ne}),_e]})]})}));e.SelectSingle=b}));
//# sourceMappingURL=SelectSingle-b6dbe05e.js.map
