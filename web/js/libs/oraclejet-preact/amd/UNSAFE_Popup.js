define(['exports', 'preact/jsx-runtime', 'preact/hooks', './UNSAFE_Floating', './utils/PRIVATE_tabbableUtils', './utils/PRIVATE_refUtils', './UNSAFE_FocusTrap', './UNSAFE_Layer', 'preact/compat', './hooks/PRIVATE_useAnimationStatus', './utils/PRIVATE_floatingUtils', './hooks/UNSAFE_useUser', './hooks/UNSAFE_useComponentTheme', './UNSAFE_Popup/themes/PopupContract.css', './utils/UNSAFE_stringUtils', './utils/UNSAFE_classNames', './UNSAFE_Popup/themes/redwood/PopupTheme', './stringUtils-46147426', './Floating-86f9017c', './classNames-711dac8e', './FocusTrap-84b5ca93', './index-f653d9ca', './index-182af2cd', 'preact', './Common', './Common/themes', './Common/themes/redwood/theme', './Common/themes/themeContract.css', './hooks/UNSAFE_useOutsideClick', './utils/UNSAFE_arrayUtils', './utils/UNSAFE_logger', './_curry1-ce36c4e7', './_curry2-d90c5517', './utils-7a8b0c59', './UNSAFE_Floating/themes/redwood/FloatingTheme', './UNSAFE_Floating/themes/FloatingStyles.css', 'css!./FloatingStyles.styles.css', './UNSAFE_Floating/themes/redwood/FloatingBaseTheme.css', 'module', './UNSAFE_Floating/themes/redwood/FloatingVariants.css', './vanilla-extract-recipes-createRuntimeFn.esm-9d536a1b', './vanilla-extract-dynamic.esm-acef6fab', './UNSAFE_Floating/themes/FloatingContract.css', './_arity-cb8e3705', './_curry3-4fb0ed44', './useThemeInterpolations-48286702', './hooks/UNSAFE_useColorScheme', './hooks/UNSAFE_useScale', './utils/UNSAFE_interpolations/theme', './UNSAFE_Theme', './utils/UNSAFE_mergeInterpolations', './_has-580e26f1', './hooks/UNSAFE_useAnimation', './useAnimation-95b1d0bd', './UNSAFE_Popup/themes/redwood/PopupBaseTheme.css', 'module', './UNSAFE_Popup/themes/redwood/PopupVariants.css', 'css!./PopupStyles.styles.css', 'module'], (function(t,e,o,n,r,s,i,a,c,l,u,m,p,f,h,d,g,A,b,E,F,S,_,U,N,y,T,P,O,x,k,C,R,v,w,V,I,j,$,B,D,L,M,X,Y,z,W,K,q,G,H,J,Q,Z,tt,et,ot,nt,rt){"use strict";const st={opening:t=>{const e=at(t.placement,t.direction);return{from:{scaleX:0,scaleY:0,opacity:0,transformOrigin:it[e]},to:{scaleX:1,scaleY:1,opacity:1,transformOrigin:it[e]},options:{duration:200}}},closing:t=>{const e=at(t.placement,t.direction);return{from:{scaleX:1,scaleY:1,opacity:1,transformOrigin:it[e]},to:{scaleX:0,scaleY:0,opacity:0,transformOrigin:it[e]},options:{duration:200}}}},it={top:"center bottom","top-right":"right bottom","top-left":"left bottom","top-right-corner":"left bottom","top-left-corner":"right bottom",right:"left center","right-top":"left top","right-bottom":"left bottom","right-top-corner":"left bottom","right-bottom-corner":"left top",bottom:"center top","bottom-right":"right top","bottom-left":"left top","bottom-right-corner":"left top","bottom-left-corner":"right top",left:"right center","left-top":"right top","left-bottom":"right bottom","left-top-corner":"right bottom","left-bottom-corner":"right top"},at=(t,e)=>{if(null==t||null==e)return"bottom";const o=t.split("-")[0],n=t.split("-")[1],r=t.split("-")[2],s=u.normalizePosition(o,e),i=["top","top-right","top-left","top-right-corner","top-left-corner","right","right-top","right-bottom","right-top-corner","right-bottom-corner","bottom","bottom-right","bottom-left","bottom-right-corner","bottom-left-corner","left","left-top","left-bottom","left-top-corner","left-bottom-corner"].filter((t=>n&&r&&t===`${s}-${u.normalizePosition(n,e)}-${r}`||n&&!r&&t===`${s}-${u.normalizePosition(n,e)}`||!n&&t===`${s}`))[0];return i||"bottom"};const ct=c.forwardRef((({anchorRef:t,children:n,isOpen:i=!1,offset:c={mainAxis:0,crossAxis:0},flipOptions:u={mainAxis:!0,crossAxis:!0},shiftOptions:h={mainAxis:!1,crossAxis:!1},onClose:d,initialFocus:S="auto",onClickOutside:_,placement:U="top",tail:N="none",onTransitionEnd:y,role:T="tooltip"},P)=>{const[O,x]=o.useState(!0),k=o.useRef(null),[C,R]=o.useState(),v=o.useRef(null),[w,V]=o.useState(U);function I(t){k.current===r.getActiveElement()&&"F6"===t.code&&(t.preventDefault(),t.stopPropagation(),r.focusWithin(v.current))}const{setAnimationElementRef:j,status:$}=function(t){const{isOpen:e,isAnimatedOnMount:n,onTransitionEnd:r,placement:s}=t,{direction:i}=m.useUser(),{setAnimationElementRef:a,animationElementRef:c,status:u}=l.useAnimationStatus({isOpen:e,isAnimatedOnMount:n,animationStates:st,onTransitionEnd:r}),p=c;return o.useEffect((()=>{null!=p&&null!=p.current&&"unmounted"!=u&&(p.current.placement=s,p.current.direction=i)}),[p,s,i,u]),{setAnimationElementRef:a,status:u}}({isOpen:i,isAnimatedOnMount:!0,onTransitionEnd:t=>{t?(D(),y?.(!0)):y?.(!1)},placement:w}),B=o.useMemo((()=>s.mergeRefs(j,P)),[j,P]);o.useEffect((()=>{i||"opening"!==$||v.current?.contains(r.getActiveElement())&&(()=>{const e=k.current,o=t.current;e?r.focusOn(e):o&&o instanceof Element&&r.focusOn(o)})()}),[i,$]),o.useEffect((()=>(i&&t.current instanceof Element&&(r.getActiveElement()===document.body?k.current=t.current:k.current=r.getActiveElement(),k.current?.addEventListener("keydown",I)),()=>{k.current?.removeEventListener("keydown",I)})),[i]);const D=()=>{let t=S;"auto"===S&&(t="none"),"popup"===t&&r.focusOn(v.current),"firstFocusable"===t&&r.focusWithin(v.current)},L={mainAxis:(t=>{let e=0;return t&&(e="number"==typeof t?t:t.mainAxis||0,"simple"===N&&(e+=5)),e})(c),crossAxis:(t=>t?"number"==typeof t?0:t.crossAxis||0:0)(c)},M=o.useCallback((t=>{U!==t.placement&&V(t.placement)}),[V,U]);o.useLayoutEffect((()=>{if("unmounted"===$||null==v.current||null!=C||"none"===N)return;const t=A.getVarName(f.popupVars.backgroundColor),e=getComputedStyle(v.current);R(e.getPropertyValue(t))}),[$,v,C,N]);const{baseTheme:X,classes:Y}=p.useComponentTheme(g.PopupRedwoodTheme);return"unmounted"!==$&&e.jsx(a.Layer,{children:e.jsx(b.Floating,{ref:B,backgroundColor:C,anchorRef:t,placement:U,offsetValue:L,flipOptions:u,shiftOptions:h,onClickOutside:_,tail:N,onPosition:M,children:e.jsx("div",{ref:v,tabIndex:-1,role:T,className:E.classNames([X,Y]),onFocus:t=>{v.current?.contains(t.relatedTarget)&&t.relatedTarget!==v.current||t.target!=v.current&&x(!1)},onBlur:t=>{v.current?.contains(t.relatedTarget)&&t.relatedTarget!==v.current||x(!0)},onKeyDown:t=>{const e=r.getActiveElement(),o=v.current,n=k.current;if(o===e||o?.contains(e))switch(t.code){case"Escape":d?.(t);break;case"F6":t.preventDefault(),t.stopPropagation(),n&&r.focusOn(n),x(!0);break;case"Tab":t.target===v.current&&O&&n&&(r.focusOn(n),t.preventDefault())}},children:e.jsx(F.FocusTrap,{isDisabled:O,restoreFocusRef:!1,children:n})})})})}));t.Popup=ct,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=UNSAFE_Popup.js.map
